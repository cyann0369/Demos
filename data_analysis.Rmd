---
title: "Demos Data Analysis Notebook"
output: html_notebook
---
# Demos Data Project

## Imports

```{r}

# Better table graphics
library(reactable)
library(htmltools)

#global lib
library(tidyverse)
library(dplyr)

# plot graphs
library(ggplot2)

# package for compositional vars dimensionality reduction
library(compositions)

library(caret)  # For train/test split
library(stats) # linear reg 

# package for correlation analysis.
library('corrr')

# plot correlations
library(ggcorrplot)

# Lib for PCA


```


```{r, include=FALSE}
source("data_analysis.R", local = knitr::knit_global())
```


## Data Exploration

```{r}
data <- load_data("data/data_abs.xlsx")
glimpse(data)
```
### Checking Missing Values

```{r}
colSums(is.na(data))
```

### Visualizing the Data

```{r}
summary(data)

```

```{r}
generate_reactable_table(data)
```

## Data Analysis


```{r}
library(corrplot)
data_for_corr = data[, !(names(data) %in% c("Department", "Code"))]
corrplot(cor(data_for_corr), type="upper", order="hclust", tl.col="black", tl.srt=45)
```

### Analyse Univarié

```{r}
summary(data$HLM)
```


### Analyse Bivarié


## 

#### AJOUTER PIECHART PROPORTION DE CHAQUE PROFESSION
 
## Preprocessing


### Scaling
```{r}

# return a dataframe with scaled vars, if none are given, all columns of the dataframe will be scaled

# List of columns to normalize
columns_to_normalize <- c("HLM", "Salairemoy", "TxPauv", "NonDiplome", "txcho")

# Apply preProcess to the desired columns
df_scaled <- min_max_scaling(data, columns_to_normalize)

head(df_scaled)
```
### Train-Test Split

```{r}
set.seed(123)  # For reproducibility
train_index <- createDataPartition(df_scaled$txabs, p = 0.8, list = FALSE)
train_data <- df_transformed[train_index, ]
test_data <- df_transformed[-train_index, ]

```

```{r}
colnames(train_data)

```

 
## Linear Regression

```{r}
# Fit the linear regression model
model <- lm(txabs ~ HLM + Salairemoy + TxPauv + NonDiplome + txcho, data = train_data)
# model <- lm(txabs ~ ., data = train_data)

# Summary of the model
summary(model)

# Make predictions on the test set
predictions <- predict(model, newdata = test_data)

# Evaluate the model (e.g., using RMSE)
rmse <- sqrt(mean((test_data$txabs - predictions)^2))
cat("Root Mean Squared Error (RMSE):", rmse, "\n")
```


